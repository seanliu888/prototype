<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit">
    <meta name="force-rendering" content="webkit">
    <title>æ–°å¢å­—å…¸ç±»å‹ - ä¼˜æƒ åˆ¸ç®¡ç†ç³»ç»Ÿ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../chrome-compatibility.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f5f7fa;
        }
        .sidebar {
            min-height: 100vh;
            background: linear-gradient(180deg, #1e3c72 0%, #2a5298 100%);
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }
        .sidebar .nav-link {
            color: rgba(255,255,255,0.8);
            padding: 12px 20px;
            margin: 5px 10px;
            border-radius: 8px;
            transition: all 0.3s;
        }
        .sidebar .nav-link:hover, .sidebar .nav-link.active {
            color: #fff;
            background-color: rgba(255,255,255,0.15);
        }
        .sidebar .nav-link i {
            margin-right: 10px;
            font-size: 1.1em;
        }
        .nav-section-title {
            color: rgba(255,255,255,0.5);
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 15px 20px 8px 20px;
            margin-top: 10px;
        }
        .main-content {
            padding: 30px;
        }
        .page-header {
            background: white;
            padding: 25px 30px;
            border-radius: 10px;
            margin-bottom: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .page-header h1 {
            font-size: 24px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0;
        }
        .content-card {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .brand-logo {
            padding: 25px 20px;
            color: white;
            font-size: 20px;
            font-weight: 700;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 20px;
        }
        .form-section {
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 1px solid #e9ecef;
        }
        .form-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        .form-section-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        .form-section-title i {
            margin-right: 10px;
            color: #3498db;
        }
        .help-text {
            font-size: 13px;
            color: #7f8c8d;
            margin-top: 5px;
        }
        .required-mark {
            color: #e74c3c;
            margin-left: 3px;
        }
        /* å¤šè¯­è¨€åŒºåŸŸæ ·å¼ */
        .i18n-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 25px;
            margin-top: 10px;
        }
        .i18n-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #dee2e6;
        }
        .i18n-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            display: flex;
            align-items: center;
        }
        .i18n-title i {
            margin-right: 8px;
            color: #3498db;
        }
        .lang-item {
            background: white;
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 12px;
            border: 1px solid #e9ecef;
            transition: all 0.3s;
        }
        .lang-item:hover {
            border-color: #3498db;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.15);
        }
        .lang-item:last-child {
            margin-bottom: 0;
        }
        .lang-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .lang-flag {
            font-size: 18px;
            margin-right: 10px;
        }
        .lang-name {
            font-weight: 600;
            color: #2c3e50;
        }
        .lang-code {
            font-size: 12px;
            color: #7f8c8d;
            margin-left: 8px;
            background: #f1f3f5;
            padding: 2px 8px;
            border-radius: 4px;
        }
        .lang-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .lang-input input {
            flex: 1;
        }
        .lang-input .btn-remove {
            color: #dc3545;
            border: none;
            background: none;
            padding: 5px 10px;
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.3s;
        }
        .lang-input .btn-remove:hover {
            opacity: 1;
        }
        .add-lang-wrapper {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px dashed #dee2e6;
        }
        .add-lang-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #3498db;
            background: none;
            border: 2px dashed #3498db;
            border-radius: 8px;
            padding: 12px 20px;
            width: 100%;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .add-lang-btn:hover {
            background: rgba(52, 152, 219, 0.1);
            border-style: solid;
        }
        .lang-select-dropdown {
            position: relative;
        }
        .lang-options {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 100;
            max-height: 250px;
            overflow-y: auto;
            margin-top: 5px;
        }
        .lang-options.show {
            display: block;
        }
        .lang-option {
            padding: 10px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: background 0.2s;
        }
        .lang-option:hover {
            background: #f8f9fa;
        }
        .lang-option.disabled {
            opacity: 0.4;
            cursor: not-allowed;
            background: #f8f9fa;
        }
        .lang-option .flag {
            margin-right: 10px;
            font-size: 18px;
        }
        .lang-option .name {
            flex: 1;
        }
        .lang-option .added-badge {
            font-size: 11px;
            background: #28a745;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
        }
        .translation-hint {
            font-size: 13px;
            color: #6c757d;
            margin-top: 15px;
            padding: 10px 15px;
            background: #fff3cd;
            border-radius: 6px;
            display: flex;
            align-items: center;
        }
        .translation-hint i {
            margin-right: 8px;
            color: #856404;
        }
        .batch-actions {
            display: flex;
            gap: 10px;
        }
        .batch-actions .btn {
            font-size: 13px;
            padding: 5px 12px;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- ä¾§è¾¹æ  -->
            <div class="col-md-2 px-0 sidebar">
                <div class="brand-logo">
                    <i class="bi bi-ticket-perforated-fill me-2"></i>
                    eSIMtoursç®¡ç†ç³»ç»Ÿ
                </div>
                <nav class="nav flex-column">
                    <a class="nav-link" href="../index.html">
                        <i class="bi bi-house-door-fill"></i>é¦–é¡µæ¦‚è§ˆ
                    </a>
                    
                    <div class="nav-section-title">æ¨¡æ¿é…ç½®</div>
                    <a class="nav-link" href="../coupon/template-list.html">
                        <i class="bi bi-file-earmark-text"></i>ä¼˜æƒ åˆ¸æ¨¡æ¿
                    </a>
                    
                    <div class="nav-section-title">å‘åˆ¸ç®¡ç†</div>
                    <a class="nav-link" href="../coupon/coupon-list.html">
                        <i class="bi bi-ticket-detailed"></i>ä¼˜æƒ ç ç®¡ç†
                    </a>
                    <a class="nav-link" href="../coupon/batch-list.html">
                        <i class="bi bi-layers"></i>æ‰¹æ¬¡ç®¡ç†
                    </a>
                    <a class="nav-link" href="../coupon/marketing-activity-list.html">
                        <i class="bi bi-megaphone"></i>è¥é”€æ´»åŠ¨
                    </a>
                    
                    <div class="nav-section-title">æ•°æ®åˆ†æ</div>
                    <a class="nav-link" href="../usage-log.html">
                        <i class="bi bi-clock-history"></i>ä½¿ç”¨è®°å½•
                    </a>
                    <a class="nav-link" href="../statistics.html">
                        <i class="bi bi-bar-chart-fill"></i>æ•°æ®ç»Ÿè®¡
                    </a>
                    <a class="nav-link" href="../operation-log.html">
                        <i class="bi bi-journal-text"></i>æ“ä½œæ—¥å¿—
                    </a>
                    
                    <div class="nav-section-title">ç³»ç»Ÿç®¡ç†</div>
                    <a class="nav-link active" href="dict-type-list.html">
                        <i class="bi bi-book"></i>æ•°æ®å­—å…¸
                    </a>
                    
                    <div class="nav-section-title">å¸®åŠ©</div>
                    <a class="nav-link" href="../help.html">
                        <i class="bi bi-question-circle-fill"></i>ä½¿ç”¨è¯´æ˜
                    </a>
                </nav>
            </div>

            <!-- ä¸»å†…å®¹åŒº -->
            <div class="col-md-10 main-content">
                <div class="page-header">
                    <h1><i class="bi bi-plus-circle me-2"></i>æ–°å¢å­—å…¸ç±»å‹</h1>
                    <small class="text-muted"><a href="dict-type-list.html" class="text-decoration-none">å­—å…¸ç±»å‹</a> / æ–°å¢å­—å…¸ç±»å‹</small>
                </div>

                <div class="row">
                    <div class="col-md-8">
                        <div class="content-card">
                            <!-- æç¤ºä¿¡æ¯ -->
                            <div class="alert alert-info mb-4">
                                <i class="bi bi-lightbulb me-2"></i>
                                <strong>å¡«å†™è¯´æ˜ï¼š</strong>
                                <ul class="mb-0 mt-2">
                                    <li>å­—å…¸ç±»å‹æ˜¯å¿…å¡«é¡¹ï¼Œéœ€ç¡®ä¿å”¯ä¸€æ€§ï¼Œå»ºè®®ä½¿ç”¨ä¸‹åˆ’çº¿å‘½åæ³•ï¼ˆå¦‚ï¼šsys_user_statusï¼‰</li>
                                    <li>å­—å…¸åç§°ï¼ˆä¸­æ–‡ï¼‰æ˜¯å¿…å¡«é¡¹ï¼Œä½œä¸ºé»˜è®¤è¯­è¨€æ˜¾ç¤º</li>
                                    <li>å¯åœ¨ä¸‹æ–¹æ·»åŠ å…¶ä»–è¯­è¨€çš„ç¿»è¯‘ï¼Œä¹Ÿå¯ä¿å­˜ååœ¨ç¼–è¾‘é¡µé¢æ·»åŠ </li>
                                    <li>å¤‡æ³¨å­—æ®µç”¨äºå†…éƒ¨è¯´æ˜ï¼Œä¸éœ€è¦ç¿»è¯‘</li>
                                </ul>
                            </div>

                            <form id="dictTypeForm">
                                <!-- åŸºæœ¬ä¿¡æ¯ -->
                                <div class="form-section">
                                    <div class="form-section-title">
                                        <i class="bi bi-info-circle-fill"></i>
                                        åŸºæœ¬ä¿¡æ¯
                                    </div>
                                    <div class="row">
                                        <div class="col-md-12 mb-3">
                                            <label class="form-label">
                                                å­—å…¸ç±»å‹<span class="required-mark">*</span>
                                            </label>
                                            <input type="text" class="form-control" id="dictType" 
                                                   placeholder="è¯·è¾“å…¥å­—å…¸ç±»å‹ï¼Œå¦‚ï¼šsys_user_status" required>
                                            <div class="help-text">
                                                <i class="bi bi-info-circle"></i> 
                                                å­—å…¸ç±»å‹å”¯ä¸€æ ‡è¯†ï¼Œç”¨äºç³»ç»Ÿè°ƒç”¨ï¼Œå»ºè®®ä½¿ç”¨ä¸‹åˆ’çº¿å‘½åæ³•
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3">
                                            <label class="form-label">
                                                å­—å…¸åç§°ï¼ˆä¸­æ–‡ï¼‰<span class="required-mark">*</span>
                                            </label>
                                            <input type="text" class="form-control" id="dictName" 
                                                   placeholder="è¯·è¾“å…¥å­—å…¸åç§°" required>
                                            <div class="help-text">
                                                <i class="bi bi-info-circle"></i> 
                                                é»˜è®¤è¯­è¨€çš„å­—å…¸åç§°ï¼Œæ˜¾ç¤ºåœ¨ç•Œé¢ä¸Š
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">æ’åº</label>
                                            <input type="number" class="form-control" id="sortOrder" 
                                                   value="0" min="0" placeholder="è¯·è¾“å…¥æ’åºå·">
                                            <div class="help-text">æ•°å­—è¶Šå°è¶Šé å‰</div>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">
                                                çŠ¶æ€<span class="required-mark">*</span>
                                            </label>
                                            <div class="mt-2">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="status" 
                                                           id="statusActive" value="1" checked>
                                                    <label class="form-check-label" for="statusActive">å¯ç”¨</label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="status" 
                                                           id="statusDisabled" value="0">
                                                    <label class="form-check-label" for="statusDisabled">ç¦ç”¨</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3">
                                            <label class="form-label">å¤‡æ³¨</label>
                                            <textarea class="form-control" id="remark" rows="3" 
                                                      placeholder="è¯·è¾“å…¥å¤‡æ³¨ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰"></textarea>
                                        </div>
                                    </div>
                                </div>

                                <!-- å¤šè¯­è¨€ç¿»è¯‘ -->
                                <div class="form-section">
                                    <div class="form-section-title">
                                        <i class="bi bi-translate"></i>
                                        å¤šè¯­è¨€ç¿»è¯‘
                                        <span class="badge bg-secondary ms-2" style="font-size: 12px; font-weight: normal;">å¯é€‰</span>
                                    </div>
                                    
                                    <div class="i18n-section">
                                        <div class="i18n-header">
                                            <div class="i18n-title">
                                                <i class="bi bi-globe2"></i>
                                                è¯­è¨€ç¿»è¯‘åˆ—è¡¨
                                                <span class="badge bg-primary ms-2" id="langCount">0 ç§è¯­è¨€</span>
                                            </div>
                                            <div class="batch-actions">
                                                <button type="button" class="btn btn-outline-primary btn-sm" onclick="addAllLangs()">
                                                    <i class="bi bi-plus-square me-1"></i>æ·»åŠ å…¨éƒ¨
                                                </button>
                                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="clearAllLangs()">
                                                    <i class="bi bi-x-square me-1"></i>æ¸…ç©ºå…¨éƒ¨
                                                </button>
                                            </div>
                                        </div>

                                        <!-- å·²æ·»åŠ çš„è¯­è¨€åˆ—è¡¨ -->
                                        <div id="langList">
                                            <!-- åŠ¨æ€æ·»åŠ çš„è¯­è¨€é¡¹ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                                        </div>

                                        <!-- æ·»åŠ è¯­è¨€ -->
                                        <div class="add-lang-wrapper">
                                            <div class="lang-select-dropdown">
                                                <button type="button" class="add-lang-btn" onclick="toggleLangOptions()">
                                                    <i class="bi bi-plus-circle"></i>
                                                    <span>æ·»åŠ è¯­è¨€ç¿»è¯‘</span>
                                                </button>
                                                <div class="lang-options" id="langOptions">
                                                    <!-- è¯­è¨€é€‰é¡¹ä¼šåŠ¨æ€ç”Ÿæˆ -->
                                                </div>
                                            </div>
                                        </div>

                                        <div class="translation-hint">
                                            <i class="bi bi-info-circle-fill"></i>
                                            <span>æç¤ºï¼šæ·»åŠ å¤šè¯­è¨€ç¿»è¯‘å¯ä»¥è®©ç³»ç»Ÿæ”¯æŒå›½é™…åŒ–æ˜¾ç¤ºã€‚å¦‚æœæš‚æ—¶ä¸éœ€è¦ï¼Œå¯ä»¥å…ˆä¿å­˜ï¼Œåç»­åœ¨ç¼–è¾‘é¡µé¢æ·»åŠ ã€‚</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- æäº¤æŒ‰é’® -->
                                <div class="d-flex justify-content-end gap-2">
                                    <button type="button" class="btn btn-secondary" 
                                            onclick="window.location.href='dict-type-list.html'">
                                        <i class="bi bi-x-circle me-1"></i>å–æ¶ˆ
                                    </button>
                                    <button type="button" class="btn btn-outline-primary" onclick="saveAndContinue()">
                                        <i class="bi bi-plus me-1"></i>ä¿å­˜å¹¶ç»§ç»­æ·»åŠ 
                                    </button>
                                    <button type="button" class="btn btn-primary" onclick="saveForm()">
                                        <i class="bi bi-check-circle me-1"></i>ä¿å­˜
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- å¸®åŠ©ä¿¡æ¯ -->
                    <div class="col-md-4">
                        <div class="content-card">
                            <h5 class="mb-3"><i class="bi bi-question-circle me-2"></i>å¸®åŠ©ä¿¡æ¯</h5>
                            <div class="alert alert-light">
                                <h6><i class="bi bi-bookmark me-1"></i> ä»€ä¹ˆæ˜¯æ•°æ®å­—å…¸ï¼Ÿ</h6>
                                <p class="small mb-0">æ•°æ®å­—å…¸ç”¨äºç®¡ç†ç³»ç»Ÿä¸­çš„æšä¸¾å€¼å’Œé…ç½®é¡¹ï¼Œæ”¯æŒå¤šè¯­è¨€ç¿»è¯‘ã€‚åˆ›å»ºå­—å…¸ç±»å‹åï¼Œå¯ä»¥åœ¨è¯¥ç±»å‹ä¸‹æ·»åŠ å…·ä½“çš„å­—å…¸æ•°æ®é¡¹ã€‚</p>
                            </div>
                            <div class="alert alert-light">
                                <h6><i class="bi bi-translate me-1"></i> å¤šè¯­è¨€æ”¯æŒ</h6>
                                <p class="small mb-0">å­—å…¸æ”¯æŒä¸­æ–‡ã€è‹±æ–‡ã€æ—¥æ–‡ã€è¥¿ç­ç‰™æ–‡ç­‰å¤šç§è¯­è¨€ã€‚å¯ä»¥åœ¨åˆ›å»ºæ—¶ç›´æ¥æ·»åŠ ç¿»è¯‘ï¼Œä¹Ÿå¯ä»¥åç»­åœ¨ç¼–è¾‘é¡µé¢é…ç½®ã€‚</p>
                            </div>
                            <div class="alert alert-light mb-0">
                                <h6><i class="bi bi-code-slash me-1"></i> å‘½åè§„èŒƒ</h6>
                                <p class="small mb-0">å­—å…¸ç±»å‹å»ºè®®ä½¿ç”¨å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿ï¼Œå¦‚ï¼š<code>sys_user_status</code>ã€<code>coupon_type</code></p>
                            </div>
                        </div>

                        <!-- æ”¯æŒçš„è¯­è¨€åˆ—è¡¨ -->
                        <div class="content-card mt-3">
                            <h5 class="mb-3"><i class="bi bi-globe me-2"></i>æ”¯æŒçš„è¯­è¨€</h5>
                            <div class="table-responsive">
                                <table class="table table-sm table-borderless mb-0">
                                    <tbody>
                                        <tr><td>ğŸ‡¨ğŸ‡³</td><td>ç®€ä½“ä¸­æ–‡</td><td class="text-muted">zh_CNï¼ˆé»˜è®¤ï¼‰</td></tr>
                                        <tr><td>ğŸ‡ºğŸ‡¸</td><td>è‹±è¯­</td><td class="text-muted">en_US</td></tr>
                                        <tr><td>ğŸ‡¯ğŸ‡µ</td><td>æ—¥è¯­</td><td class="text-muted">ja_JP</td></tr>
                                        <tr><td>ğŸ‡ªğŸ‡¸</td><td>è¥¿ç­ç‰™è¯­</td><td class="text-muted">es_ES</td></tr>
                                        <tr><td>ğŸ‡«ğŸ‡·</td><td>æ³•è¯­</td><td class="text-muted">fr_FR</td></tr>
                                        <tr><td>ğŸ‡©ğŸ‡ª</td><td>å¾·è¯­</td><td class="text-muted">de_DE</td></tr>
                                        <tr><td>ğŸ‡°ğŸ‡·</td><td>éŸ©è¯­</td><td class="text-muted">ko_KR</td></tr>
                                        <tr><td>ğŸ‡·ğŸ‡º</td><td>ä¿„è¯­</td><td class="text-muted">ru_RU</td></tr>
                                        <tr><td>ğŸ‡µğŸ‡¹</td><td>è‘¡è„ç‰™è¯­</td><td class="text-muted">pt_PT</td></tr>
                                        <tr><td>ğŸ‡®ğŸ‡¹</td><td>æ„å¤§åˆ©è¯­</td><td class="text-muted">it_IT</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // å¯ç”¨è¯­è¨€åˆ—è¡¨
        const availableLanguages = [
            { code: 'en_US', name: 'è‹±è¯­', flag: 'ğŸ‡ºğŸ‡¸', placeholder: 'Please enter dictionary name' },
            { code: 'ja_JP', name: 'æ—¥è¯­', flag: 'ğŸ‡¯ğŸ‡µ', placeholder: 'è¾æ›¸åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„' },
            { code: 'es_ES', name: 'è¥¿ç­ç‰™è¯­', flag: 'ğŸ‡ªğŸ‡¸', placeholder: 'Por favor ingrese el nombre' },
            { code: 'fr_FR', name: 'æ³•è¯­', flag: 'ğŸ‡«ğŸ‡·', placeholder: 'Veuillez saisir le nom' },
            { code: 'de_DE', name: 'å¾·è¯­', flag: 'ğŸ‡©ğŸ‡ª', placeholder: 'Bitte geben Sie den Namen ein' },
            { code: 'ko_KR', name: 'éŸ©è¯­', flag: 'ğŸ‡°ğŸ‡·', placeholder: 'ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”' },
            { code: 'ru_RU', name: 'ä¿„è¯­', flag: 'ğŸ‡·ğŸ‡º', placeholder: 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ' },
            { code: 'pt_PT', name: 'è‘¡è„ç‰™è¯­', flag: 'ğŸ‡µğŸ‡¹', placeholder: 'Por favor, insira o nome' },
            { code: 'it_IT', name: 'æ„å¤§åˆ©è¯­', flag: 'ğŸ‡®ğŸ‡¹', placeholder: 'Inserisci il nome' },
            { code: 'ar_SA', name: 'é˜¿æ‹‰ä¼¯è¯­', flag: 'ğŸ‡¸ğŸ‡¦', placeholder: 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù…' }
        ];

        // å·²æ·»åŠ çš„è¯­è¨€
        let addedLanguages = [];

        // åˆå§‹åŒ–è¯­è¨€é€‰é¡¹
        function initLangOptions() {
            const optionsContainer = document.getElementById('langOptions');
            optionsContainer.innerHTML = availableLanguages.map(lang => {
                const isAdded = addedLanguages.includes(lang.code);
                return `
                    <div class="lang-option ${isAdded ? 'disabled' : ''}" 
                         onclick="${isAdded ? '' : `addLanguage('${lang.code}')`}">
                        <span class="flag">${lang.flag}</span>
                        <span class="name">${lang.name}</span>
                        ${isAdded ? '<span class="added-badge">å·²æ·»åŠ </span>' : ''}
                    </div>
                `;
            }).join('');
        }

        // åˆ‡æ¢è¯­è¨€é€‰é¡¹ä¸‹æ‹‰æ¡†
        function toggleLangOptions() {
            const options = document.getElementById('langOptions');
            options.classList.toggle('show');
        }

        // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­ä¸‹æ‹‰æ¡†
        document.addEventListener('click', function(e) {
            const dropdown = document.querySelector('.lang-select-dropdown');
            const options = document.getElementById('langOptions');
            if (!dropdown.contains(e.target)) {
                options.classList.remove('show');
            }
        });

        // æ·»åŠ è¯­è¨€
        function addLanguage(langCode) {
            if (addedLanguages.includes(langCode)) return;
            
            const lang = availableLanguages.find(l => l.code === langCode);
            if (!lang) return;

            addedLanguages.push(langCode);
            
            const langList = document.getElementById('langList');
            const langItem = document.createElement('div');
            langItem.className = 'lang-item';
            langItem.id = `lang-${langCode}`;
            langItem.innerHTML = `
                <div class="lang-header">
                    <span class="lang-flag">${lang.flag}</span>
                    <span class="lang-name">${lang.name}</span>
                    <span class="lang-code">${lang.code}</span>
                </div>
                <div class="lang-input">
                    <input type="text" class="form-control" 
                           id="dictName_${langCode}" 
                           placeholder="${lang.placeholder}"
                           data-lang="${langCode}">
                    <button type="button" class="btn-remove" onclick="removeLanguage('${langCode}')" title="ç§»é™¤">
                        <i class="bi bi-trash"></i>
                    </button>
                </div>
            `;
            langList.appendChild(langItem);

            // æ›´æ–°é€‰é¡¹å’Œè®¡æ•°
            initLangOptions();
            updateLangCount();
            
            // å…³é—­ä¸‹æ‹‰æ¡†
            document.getElementById('langOptions').classList.remove('show');
        }

        // ç§»é™¤è¯­è¨€
        function removeLanguage(langCode) {
            addedLanguages = addedLanguages.filter(code => code !== langCode);
            const langItem = document.getElementById(`lang-${langCode}`);
            if (langItem) {
                langItem.remove();
            }
            initLangOptions();
            updateLangCount();
        }

        // æ›´æ–°è¯­è¨€è®¡æ•°
        function updateLangCount() {
            const countBadge = document.getElementById('langCount');
            countBadge.textContent = `${addedLanguages.length} ç§è¯­è¨€`;
        }

        // æ·»åŠ å…¨éƒ¨è¯­è¨€
        function addAllLangs() {
            availableLanguages.forEach(lang => {
                if (!addedLanguages.includes(lang.code)) {
                    addLanguage(lang.code);
                }
            });
        }

        // æ¸…ç©ºå…¨éƒ¨è¯­è¨€
        function clearAllLangs() {
            if (addedLanguages.length === 0) return;
            
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å·²æ·»åŠ çš„è¯­è¨€ç¿»è¯‘å—ï¼Ÿ')) {
                addedLanguages = [];
                document.getElementById('langList').innerHTML = '';
                initLangOptions();
                updateLangCount();
            }
        }

        // æ”¶é›†å¤šè¯­è¨€æ•°æ®
        function collectI18nData() {
            const i18nData = {};
            addedLanguages.forEach(langCode => {
                const input = document.getElementById(`dictName_${langCode}`);
                if (input && input.value.trim()) {
                    i18nData[langCode] = input.value.trim();
                }
            });
            return i18nData;
        }

        // ä¿å­˜è¡¨å•
        function saveForm() {
            const dictType = document.getElementById('dictType').value.trim();
            const dictName = document.getElementById('dictName').value.trim();
            
            if (!dictType || !dictName) {
                alert('è¯·å¡«å†™å¿…å¡«é¡¹ï¼');
                return;
            }
            
            // æ”¶é›†å¤šè¯­è¨€æ•°æ®
            const i18nData = collectI18nData();
            const langCount = Object.keys(i18nData).length;
            
            // æ¨¡æ‹Ÿä¿å­˜
            console.log('ä¿å­˜æ•°æ®:', {
                dictType,
                dictName,
                sortOrder: document.getElementById('sortOrder').value,
                status: document.querySelector('input[name="status"]:checked').value,
                remark: document.getElementById('remark').value,
                i18n: i18nData
            });
            
            let msg = 'ä¿å­˜æˆåŠŸï¼';
            if (langCount > 0) {
                msg += `\nå·²æ·»åŠ  ${langCount} ç§è¯­è¨€ç¿»è¯‘ã€‚`;
            }
            alert(msg);
            window.location.href = 'dict-type-list.html';
        }
        
        // ä¿å­˜å¹¶ç»§ç»­æ·»åŠ 
        function saveAndContinue() {
            const dictType = document.getElementById('dictType').value.trim();
            const dictName = document.getElementById('dictName').value.trim();
            
            if (!dictType || !dictName) {
                alert('è¯·å¡«å†™å¿…å¡«é¡¹ï¼');
                return;
            }
            
            // æ”¶é›†å¤šè¯­è¨€æ•°æ®
            const i18nData = collectI18nData();
            const langCount = Object.keys(i18nData).length;
            
            let msg = 'ä¿å­˜æˆåŠŸï¼æ‚¨å¯ä»¥ç»§ç»­æ·»åŠ æ–°çš„å­—å…¸ç±»å‹ã€‚';
            if (langCount > 0) {
                msg += `\nå·²æ·»åŠ  ${langCount} ç§è¯­è¨€ç¿»è¯‘ã€‚`;
            }
            alert(msg);
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('dictType').value = '';
            document.getElementById('dictName').value = '';
            document.getElementById('sortOrder').value = '0';
            document.getElementById('remark').value = '';
            document.getElementById('statusActive').checked = true;
            
            // æ¸…ç©ºå¤šè¯­è¨€
            addedLanguages = [];
            document.getElementById('langList').innerHTML = '';
            initLangOptions();
            updateLangCount();
            
            document.getElementById('dictType').focus();
        }

        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initLangOptions();
        });
    </script>
</body>
</html>
