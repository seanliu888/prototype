<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit">
    <meta name="force-rendering" content="webkit">
    <title>录入提现</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../chrome-compatibility.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f5f7fa;
        }
        .sidebar {
            min-height: 100vh;
            background: linear-gradient(180deg, #1e3c72 0%, #2a5298 100%);
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }
        .sidebar .nav-link {
            color: rgba(255,255,255,0.8);
            padding: 12px 20px;
            margin: 5px 10px;
            border-radius: 8px;
            transition: all 0.3s;
        }
        .sidebar .nav-link:hover, .sidebar .nav-link.active {
            color: #fff;
            background-color: rgba(255,255,255,0.15);
        }
        .sidebar .nav-link i {
            margin-right: 10px;
            font-size: 1.1em;
        }
        .nav-section-title {
            color: rgba(255,255,255,0.5);
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 15px 20px 8px 20px;
            margin-top: 10px;
        }
        .main-content {
            padding: 30px;
        }
        .page-header {
            background: white;
            padding: 25px 30px;
            border-radius: 10px;
            margin-bottom: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .page-header h1 {
            font-size: 24px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0;
        }
        .content-card {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }
        .brand-logo {
            padding: 25px 20px;
            color: white;
            font-size: 20px;
            font-weight: 700;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 20px;
        }
        .form-section-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        .amount-preview {
            font-size: 36px;
            font-weight: 700;
            font-family: 'Courier New', monospace;
        }
        .amount-cny { color: #e74c3c; }
        .amount-usd { color: #27ae60; }
        .amount-jpy { color: #3498db; }
        .amount-eur { color: #9b59b6; }
        .channel-option {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .channel-option:hover {
            border-color: #3498db;
        }
        .channel-option.selected {
            border-color: #3498db;
            background: #e8f4fd;
        }
        .channel-option i {
            font-size: 32px;
            margin-bottom: 8px;
        }
        .channel-alipay i { color: #1677ff; }
        .channel-wechat i { color: #07c160; }
        .channel-bank i { color: #fa8c16; }
        .channel-paypal i { color: #003087; }
        .distributor-info {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #3498db;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- 侧边栏 -->
            <div class="col-md-2 px-0 sidebar">
                <div class="brand-logo">
                    <i class="bi bi-ticket-perforated-fill me-2"></i>
                    eSIMtours管理系统
                </div>
                <nav class="nav flex-column">
                    <a class="nav-link" href="../index.html">
                        <i class="bi bi-house-door-fill"></i>首页概览
                    </a>
                    
                    <div class="nav-section-title">模板配置</div>
                    <a class="nav-link" href="../coupon/template-list.html">
                        <i class="bi bi-file-earmark-text"></i>优惠券模板
                    </a>
                    
                    <div class="nav-section-title">发券管理</div>
                    <a class="nav-link" href="../coupon/coupon-list.html">
                        <i class="bi bi-ticket-detailed"></i>优惠码管理
                    </a>
                    <a class="nav-link" href="../coupon/batch-list.html">
                        <i class="bi bi-layers"></i>批次管理
                    </a>
                    <a class="nav-link" href="../coupon/marketing-activity-list.html">
                        <i class="bi bi-megaphone"></i>营销活动
                    </a>
                    
                    <div class="nav-section-title">分销商管理</div>
                    <a class="nav-link" href="distributor-list.html">
                        <i class="bi bi-shop"></i>分销商列表
                    </a>
                    <a class="nav-link" href="salesman-list.html">
                        <i class="bi bi-people"></i>业务员管理
                    </a>
                    <a class="nav-link active" href="withdrawal-list.html">
                        <i class="bi bi-cash-stack"></i>分销商提现
                    </a>
                    
                    <div class="nav-section-title">数据分析</div>
                    <a class="nav-link" href="../usage-log.html">
                        <i class="bi bi-clock-history"></i>使用记录
                    </a>
                    <a class="nav-link" href="../statistics.html">
                        <i class="bi bi-bar-chart-fill"></i>数据统计
                    </a>
                    <a class="nav-link" href="../operation-log.html">
                        <i class="bi bi-journal-text"></i>操作日志
                    </a>
                    
                    <div class="nav-section-title">系统管理</div>
                    <a class="nav-link" href="../dictionary/dict-type-list.html">
                        <i class="bi bi-book"></i>数据字典
                    </a>
                    
                    <div class="nav-section-title">帮助</div>
                    <a class="nav-link" href="../help.html">
                        <i class="bi bi-question-circle-fill"></i>使用说明
                    </a>
                </nav>
            </div>

            <!-- 主内容区 -->
            <div class="col-md-10 main-content">
                <div class="page-header d-flex justify-content-between align-items-center">
                    <div>
                        <h1><i class="bi bi-plus-circle me-2"></i>录入提现</h1>
                        <small class="text-muted">录入提现记录，触发对分销商的返现操作</small>
                    </div>
                    <button class="btn btn-outline-secondary" onclick="window.location.href='withdrawal-list.html'">
                        <i class="bi bi-arrow-left me-1"></i>返回列表
                    </button>
                </div>

                <!-- 提示信息 -->
                <div class="alert alert-warning d-flex align-items-center mb-4">
                    <i class="bi bi-exclamation-triangle-fill me-3" style="font-size: 24px;"></i>
                    <div>
                        <strong>注意：</strong>录入提现后将立即触发对分销商的返现操作，请仔细核对信息后再提交。
                    </div>
                </div>

                <form id="withdrawalForm" onsubmit="return submitForm()">
                    <div class="row">
                        <div class="col-md-8">
                            <!-- 分销商选择 -->
                            <div class="content-card">
                                <h5 class="form-section-title">
                                    <i class="bi bi-shop me-2"></i>选择分销商
                                </h5>
                                
                                <div class="mb-3">
                                    <label class="form-label"><span class="text-danger">*</span> 分销商</label>
                                    <select class="form-select form-select-lg" id="distributor" required onchange="updateDistributorInfo()">
                                        <option value="">请选择分销商</option>
                                        <option value="D1001" data-name="张明远" data-email="zhangmy@example.com" data-balance="15680.50" data-currency="CNY">张明远 (D1001) - 待结算: ¥15,680.50</option>
                                        <option value="D1002" data-name="李婷婷" data-email="ltt@partner.co" data-balance="8520.00" data-currency="USD">李婷婷 (D1002) - 待结算: $8,520.00</option>
                                        <option value="D1003" data-name="王大伟" data-email="wdw@travel.jp" data-balance="256800" data-currency="JPY">王大伟 (D1003) - 待结算: ¥256,800</option>
                                        <option value="D1004" data-name="陈思雨" data-email="chensy@sg-travel.com" data-balance="3250.00" data-currency="USD">陈思雨 (D1004) - 待结算: $3,250.00</option>
                                    </select>
                                </div>
                                
                                <div class="distributor-info" id="distributorInfo" style="display: none;">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <small class="text-muted">分销商名称</small>
                                            <div class="fw-bold" id="infoName">-</div>
                                        </div>
                                        <div class="col-md-4">
                                            <small class="text-muted">联系邮箱</small>
                                            <div id="infoEmail">-</div>
                                        </div>
                                        <div class="col-md-4">
                                            <small class="text-muted">待结算金额</small>
                                            <div class="fw-bold text-success" id="infoBalance">-</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 提现渠道 -->
                            <div class="content-card">
                                <h5 class="form-section-title">
                                    <i class="bi bi-credit-card me-2"></i>提现渠道
                                </h5>
                                
                                <div class="row g-3 mb-3">
                                    <div class="col-md-3">
                                        <div class="channel-option channel-alipay" onclick="selectChannel('ALIPAY', this)">
                                            <i class="bi bi-alipay d-block"></i>
                                            <strong>支付宝</strong>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="channel-option channel-wechat" onclick="selectChannel('WECHAT', this)">
                                            <i class="bi bi-wechat d-block"></i>
                                            <strong>微信</strong>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="channel-option channel-bank" onclick="selectChannel('BANK', this)">
                                            <i class="bi bi-bank d-block"></i>
                                            <strong>银行转账</strong>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="channel-option channel-paypal" onclick="selectChannel('PAYPAL', this)">
                                            <i class="bi bi-paypal d-block"></i>
                                            <strong>PayPal</strong>
                                        </div>
                                    </div>
                                </div>
                                <input type="hidden" id="channel" required>
                                
                                <div class="mb-3">
                                    <label class="form-label"><span class="text-danger">*</span> 收款账号</label>
                                    <input type="text" class="form-control" id="accountNumber" placeholder="请输入收款账号（邮箱/手机号/银行卡号）" required>
                                    <div class="form-text">根据所选渠道填写对应的收款账号信息</div>
                                </div>
                            </div>

                            <!-- 金额信息 -->
                            <div class="content-card">
                                <h5 class="form-section-title">
                                    <i class="bi bi-cash me-2"></i>金额信息
                                </h5>
                                
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label"><span class="text-danger">*</span> 货币类型</label>
                                        <select class="form-select" id="currency" required onchange="updateAmountPreview()">
                                            <option value="">请选择货币类型</option>
                                            <option value="CNY">CNY - 人民币 ¥</option>
                                            <option value="USD">USD - 美元 $</option>
                                            <option value="JPY">JPY - 日元 ¥</option>
                                            <option value="EUR">EUR - 欧元 €</option>
                                            <option value="HKD">HKD - 港币 HK$</option>
                                            <option value="SGD">SGD - 新加坡元 S$</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label"><span class="text-danger">*</span> 提现金额</label>
                                        <input type="number" class="form-control" id="amount" placeholder="请输入金额" step="0.01" min="0.01" required oninput="updateAmountPreview()">
                                    </div>
                                </div>
                            </div>

                            <!-- 备注 -->
                            <div class="content-card">
                                <h5 class="form-section-title">
                                    <i class="bi bi-chat-left-text me-2"></i>备注信息
                                </h5>
                                
                                <div class="mb-0">
                                    <label class="form-label">备注</label>
                                    <textarea class="form-control" id="remark" rows="3" placeholder="可填写结算周期、备注说明等..."></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <!-- 金额预览 -->
                            <div class="content-card text-center">
                                <h6 class="text-muted mb-3">提现金额预览</h6>
                                <div class="amount-preview" id="amountPreview">
                                    <span class="text-muted">¥0.00</span>
                                </div>
                                <small class="text-muted" id="currencyLabel">请选择货币类型</small>
                            </div>

                            <!-- 操作确认 -->
                            <div class="content-card">
                                <h5 class="form-section-title">
                                    <i class="bi bi-shield-check me-2"></i>确认提交
                                </h5>
                                
                                <div class="alert alert-info mb-3">
                                    <small>
                                        <i class="bi bi-info-circle me-1"></i>
                                        提交后将立即触发返现，请确认以下信息：
                                        <ul class="mb-0 mt-2">
                                            <li>分销商信息正确</li>
                                            <li>提现渠道正确</li>
                                            <li>金额核对无误</li>
                                        </ul>
                                    </small>
                                </div>
                                
                                <div class="d-grid gap-2">
                                    <button type="submit" class="btn btn-primary btn-lg">
                                        <i class="bi bi-check-circle me-2"></i>确认录入
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="window.location.href='withdrawal-list.html'">
                                        <i class="bi bi-x-circle me-2"></i>取消
                                    </button>
                                </div>
                            </div>

                            <!-- 最近提现 -->
                            <div class="content-card">
                                <h6 class="text-muted mb-3">
                                    <i class="bi bi-clock-history me-2"></i>最近提现记录
                                </h6>
                                <div class="list-group list-group-flush">
                                    <div class="list-group-item px-0">
                                        <div class="d-flex justify-content-between">
                                            <small>张明远</small>
                                            <small class="text-success fw-bold">¥12,580</small>
                                        </div>
                                        <small class="text-muted">2025-12-15 10:30</small>
                                    </div>
                                    <div class="list-group-item px-0">
                                        <div class="d-flex justify-content-between">
                                            <small>李婷婷</small>
                                            <small class="text-success fw-bold">$2,350</small>
                                        </div>
                                        <small class="text-muted">2025-12-14 16:45</small>
                                    </div>
                                    <div class="list-group-item px-0">
                                        <div class="d-flex justify-content-between">
                                            <small>王大伟</small>
                                            <small class="text-success fw-bold">¥186,500</small>
                                        </div>
                                        <small class="text-muted">2025-12-14 11:20</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let selectedChannel = '';

        function selectChannel(channel, element) {
            // 移除其他选中状态
            document.querySelectorAll('.channel-option').forEach(el => el.classList.remove('selected'));
            // 添加当前选中状态
            element.classList.add('selected');
            selectedChannel = channel;
            document.getElementById('channel').value = channel;
            
            // 更新账号提示
            const accountInput = document.getElementById('accountNumber');
            switch(channel) {
                case 'ALIPAY':
                    accountInput.placeholder = '请输入支付宝账号（邮箱或手机号）';
                    break;
                case 'WECHAT':
                    accountInput.placeholder = '请输入微信号或绑定手机号';
                    break;
                case 'BANK':
                    accountInput.placeholder = '请输入银行卡号';
                    break;
                case 'PAYPAL':
                    accountInput.placeholder = '请输入PayPal账号（邮箱）';
                    break;
            }
        }

        function updateDistributorInfo() {
            const select = document.getElementById('distributor');
            const option = select.options[select.selectedIndex];
            const infoDiv = document.getElementById('distributorInfo');
            
            if (select.value) {
                document.getElementById('infoName').textContent = option.dataset.name;
                document.getElementById('infoEmail').textContent = option.dataset.email;
                
                const currency = option.dataset.currency;
                const balance = parseFloat(option.dataset.balance);
                let symbol = '¥';
                if (currency === 'USD') symbol = '$';
                if (currency === 'JPY') symbol = '¥';
                
                document.getElementById('infoBalance').textContent = symbol + balance.toLocaleString();
                infoDiv.style.display = 'block';
            } else {
                infoDiv.style.display = 'none';
            }
        }

        function updateAmountPreview() {
            const currency = document.getElementById('currency').value;
            const amount = parseFloat(document.getElementById('amount').value) || 0;
            const preview = document.getElementById('amountPreview');
            const label = document.getElementById('currencyLabel');
            
            let symbol = '';
            let colorClass = '';
            let currencyName = '请选择货币类型';
            
            switch(currency) {
                case 'CNY':
                    symbol = '¥';
                    colorClass = 'amount-cny';
                    currencyName = '人民币';
                    break;
                case 'USD':
                    symbol = '$';
                    colorClass = 'amount-usd';
                    currencyName = '美元';
                    break;
                case 'JPY':
                    symbol = '¥';
                    colorClass = 'amount-jpy';
                    currencyName = '日元';
                    break;
                case 'EUR':
                    symbol = '€';
                    colorClass = 'amount-eur';
                    currencyName = '欧元';
                    break;
                case 'HKD':
                    symbol = 'HK$';
                    colorClass = 'amount-cny';
                    currencyName = '港币';
                    break;
                case 'SGD':
                    symbol = 'S$';
                    colorClass = 'amount-usd';
                    currencyName = '新加坡元';
                    break;
                default:
                    preview.innerHTML = '<span class="text-muted">¥0.00</span>';
                    label.textContent = currencyName;
                    return;
            }
            
            preview.innerHTML = `<span class="${colorClass}">${symbol}${amount.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>`;
            label.textContent = currencyName;
        }

        function submitForm() {
            const distributor = document.getElementById('distributor');
            const channel = document.getElementById('channel').value;
            const currency = document.getElementById('currency').value;
            const amount = document.getElementById('amount').value;
            const account = document.getElementById('accountNumber').value;
            
            if (!channel) {
                alert('请选择提现渠道');
                return false;
            }
            
            const distributorName = distributor.options[distributor.selectedIndex].dataset.name;
            
            const channelNames = {
                'ALIPAY': '支付宝',
                'WECHAT': '微信',
                'BANK': '银行转账',
                'PAYPAL': 'PayPal'
            };
            
            const currencySymbols = {
                'CNY': '¥',
                'USD': '$',
                'JPY': '¥',
                'EUR': '€',
                'HKD': 'HK$',
                'SGD': 'S$'
            };
            
            if (confirm(`确认录入以下提现信息？\n\n分销商：${distributorName}\n提现渠道：${channelNames[channel]}\n货币类型：${currency}\n提现金额：${currencySymbols[currency]}${parseFloat(amount).toLocaleString()}\n收款账号：${account}\n\n确认后将立即触发返现！`)) {
                alert('提现录入成功！已触发返现操作。\n\n（这是一个静态演示页面）');
                window.location.href = 'withdrawal-list.html';
            }
            return false;
        }
    </script>
</body>
</html>

